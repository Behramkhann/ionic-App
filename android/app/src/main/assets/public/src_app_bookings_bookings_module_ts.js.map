{"version":3,"sources":["./src/app/bookings/booking.service.ts","./src/app/bookings/bookings-routing.module.ts","./src/app/bookings/bookings.module.ts","./src/app/bookings/bookings.page.ts","./src/app/models/booking.model.ts","./src/app/bookings/bookings.page.scss","./src/app/bookings/bookings.page.html"],"names":[],"mappings":"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","file":"src_app_bookings_bookings_module_ts.js","sourcesContent":["/* eslint-disable arrow-body-style */\n/* eslint-disable @typescript-eslint/no-unused-expressions */\n/* eslint-disable max-len */\n/* eslint-disable no-underscore-dangle */\nimport { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Key } from 'protractor';\nimport { BehaviorSubject } from 'rxjs';\nimport { delay, map, switchMap, take, tap } from 'rxjs/operators';\nimport { AuthService } from '../auth/auth.service';\nimport { Booking } from '../models/booking.model';\n\ninterface BookingData {\n  bookedFrom: string;\n  firstname: string;\n  guestNumber: number;\n  lastName: string;\n  placeId: string;\n  placeImg: string;\n  placeTitle: string;\n  userId: string;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BookingService {\n  private _bookings = new BehaviorSubject<Booking[]>([]);\n\n  get bookings() {\n    return this._bookings.asObservable();\n  }\n\n  constructor(private authService: AuthService, private http: HttpClient) {}\n\n  addBooking(\n    placeId: string,\n    placeTitle: string,\n    placeImg: string,\n    firstName: string,\n    lastName: string,\n    guestNumber: number,\n    dateFrom: Date,\n    dateTo: Date\n  ) {\n    let generatedId: string;\n    const newBooking = new Booking(\n      Math.random.toString(),\n      placeId,\n      this.authService.userId,\n      placeTitle,\n      placeImg,\n      firstName,\n      lastName,\n      guestNumber,\n      dateFrom,\n      dateTo\n    );\n    return this.http\n      .post<{ name: string }>(\n        'https://ion-app-e8ff9-default-rtdb.asia-southeast1.firebasedatabase.app/bookings.json',\n        { ...newBooking, id: null }\n      )\n      .pipe(\n        switchMap((resData) => {\n          resData.name;\n          return this.bookings;\n        }),\n        take(1),\n        tap((bookings) => {\n          newBooking.id = generatedId;\n          this._bookings.next(bookings.concat(newBooking));\n        })\n      );\n  }\n\n  fetchBookings() {\n    return this.http\n      .get<{ [key: string]: Booking }>(\n        `https://ion-app-e8ff9-default-rtdb.asia-southeast1.firebasedatabase.app/bookings.json?orderBy=\"userId\"&equalTo\"${this.authService.userId}\"`\n      )\n      .pipe(\n        map((bookingsData) => {\n          const bookings = [];\n          for (const key in bookingsData) {\n            if (bookingsData.hasOwnProperty(key)) {\n              bookings.push(\n                new Booking(\n                  key,\n                  bookingsData[key].placeId,\n                  bookingsData[key].userId,\n                  bookingsData[key].placeTitle,\n                  bookingsData[key].placeImg,\n                  bookingsData[key].firstname,\n                  bookingsData[key].lastName,\n                  bookingsData[key].guestNumber,\n                  new Date(bookingsData[key].bookedFrom),\n                  new Date(bookingsData[key].bookedTo)\n                )\n              );\n            }\n          }\n          return bookings;\n        }),\n        tap((bookings) => {\n          this._bookings.next(bookings);\n        })\n      );\n  }\n\n  cancelBooking(bookingId: string) {\n    return this.http\n      .delete(\n        `https://ion-app-e8ff9-default-rtdb.asia-southeast1.firebasedatabase.app/bookings/${bookingId}.json`\n      )\n      .pipe(\n        switchMap(() => {\n          return this.bookings;\n        }),\n        take(1),\n        tap((bookings) => {\n          this._bookings.next(\n            bookings.filter((b) => {\n              b.id = bookingId;\n            })\n          );\n        })\n      );\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { BookingsPage } from './bookings.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: BookingsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class BookingsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { BookingsPageRoutingModule } from './bookings-routing.module';\n\nimport { BookingsPage } from './bookings.page';\n\n@NgModule({\n  imports: [CommonModule, FormsModule, IonicModule, BookingsPageRoutingModule],\n  declarations: [BookingsPage],\n})\nexport class BookingsPageModule {}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { IonItemSliding, LoadingController } from '@ionic/angular';\nimport { Subscription } from 'rxjs';\nimport { Booking } from '../models/booking.model';\nimport { BookingService } from './booking.service';\n\n@Component({\n  selector: 'app-bookings',\n  templateUrl: './bookings.page.html',\n  styleUrls: ['./bookings.page.scss'],\n})\nexport class BookingsPage implements OnInit, OnDestroy {\n  loadedBookings: Booking[] = [];\n  isLoading = false;\n  private bookingSub: Subscription;\n  constructor(\n    private bookingService: BookingService,\n    private loadingCtrl: LoadingController\n  ) {}\n\n  ngOnInit() {\n    this.bookingSub = this.bookingService.bookings.subscribe((bookings) => {\n      this.loadedBookings = bookings;\n    });\n  }\n\n  ionViewWillEnter() {\n    this.isLoading = true;\n    this.bookingService.fetchBookings().subscribe(() => {\n      this.isLoading = false;\n    });\n  }\n\n  onCancelBooking(bookingId: string, ionSliding: IonItemSliding) {\n    ionSliding.close();\n    this.loadingCtrl\n      .create({ message: 'Cancelling Booking' })\n      .then((loadingEl) => {\n        loadingEl.present();\n        this.bookingService.cancelBooking(bookingId).subscribe(() => {\n          loadingEl.dismiss();\n        });\n      });\n  }\n\n  ngOnDestroy() {\n    this.bookingSub.unsubscribe();\n  }\n}\n","export class Booking {\r\n  constructor(\r\n    public id: string,\r\n    public placeId: string,\r\n    public userId: string,\r\n    public placeImg: string,\r\n    public firstname: string,\r\n    public lastName: string,\r\n    public placeTitle: string,\r\n    public guestNumber: number,\r\n    public bookedFrom: Date,\r\n    public bookedTo: Date\r\n  ) {}\r\n}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJib29raW5ncy5wYWdlLnNjc3MifQ== */\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title>Bookings</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-grid>\\n    <ion-row>\\n      <ion-col\\n        sizeMd=\\\"6\\\"\\n        offsetMd=\\\"3\\\"\\n        class=\\\"ion-text-center\\\"\\n        *ngIf=\\\"isLoading\\\"\\n      >\\n        <ion-spinner color=\\\"secondary\\\"></ion-spinner>\\n      </ion-col>\\n      <ion-col\\n        sizeMd=\\\"6\\\"\\n        offsetMd=\\\"3\\\"\\n        class=\\\"ion-text-center\\\"\\n        *ngIf=\\\" !isLoading && (!loadedBookings || loadedBookings.length <= 0)\\\"\\n      >\\n        <p>No Bookings Found</p>\\n      </ion-col>\\n      <ion-col\\n        sizeMd=\\\"6\\\"\\n        offsetMd=\\\"3\\\"\\n        *ngIf=\\\"!isLoading && (loadedBookings && loadedBookings.length > 0)\\\"\\n      >\\n        <ion-list>\\n          <ion-item-sliding\\n            *ngFor=\\\"let booking of loadedBookings\\\"\\n            #slidingBooking\\n          >\\n            <ion-item>\\n              <ion-avatar slot=\\\"start\\\">\\n                <ion-img [src]=\\\"booking.placeImg\\\"></ion-img>\\n              </ion-avatar>\\n              <ion-label>\\n                <h5>{{ booking.placeTitle }}</h5>\\n                <p>Guests {{ booking.guestNumber }}</p>\\n              </ion-label>\\n            </ion-item>\\n            <ion-item-options>\\n              <ion-item-option\\n                color=\\\"danger\\\"\\n                (click)=\\\"onCancelBooking(booking.id, slidingBooking)\\\"\\n              >\\n                <ion-icon name=\\\"trash\\\" slot=\\\"icon-only\\\"></ion-icon>\\n              </ion-item-option>\\n            </ion-item-options>\\n          </ion-item-sliding>\\n        </ion-list>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\\n\";"],"sourceRoot":"webpack:///"}